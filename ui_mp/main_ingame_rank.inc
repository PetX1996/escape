#define VIS_RANK ( DvarInt( "MAIN_sel" ) == 0 )

#define RANK_CURRENT_RANK (stat( 2350 )+1)
#define RANK_LAST_RANK (RANK_CURRENT_RANK-1)
#define RANK_NEXT_RANK (RANK_CURRENT_RANK+1)

// middle level info
#define RANK_RANK_PROGRESS_Y (MAIN_Y+(MAIN_H*0.5))
#define RANK_RANK_PROGRESS_H 20

#define RANK_RANK_CENTER_W (MAIN_W*0.55)
#define RANK_RANK_LEFT_W ((MAIN_W-RANK_RANK_CENTER_W)*0.5)
#define RANK_RANK_RIGHT_W ((MAIN_W-RANK_RANK_CENTER_W)*0.5)

#define RANK_RANK_LEFT_X MAIN_X
#define RANK_RANK_CENTER_X (RANK_RANK_LEFT_X+RANK_RANK_LEFT_W)
#define RANK_RANK_RIGHT_X (RANK_RANK_CENTER_X+RANK_RANK_CENTER_W)

// progress bar
#define RANK_RANK_PROGRESS_TICK_W 2
#define RANK_RANK_PROGRESS_TICK_H (RANK_RANK_PROGRESS_H*1.2)
#define RANK_RANK_PROGRESS_TICK_LEFT_X (RANK_RANK_CENTER_X-(RANK_RANK_PROGRESS_TICK_W*0.5))
#define RANK_RANK_PROGRESS_TICK_RIGHT_X (RANK_RANK_RIGHT_X-(RANK_RANK_PROGRESS_TICK_W*0.5))

#define RANK_RANK_PROGRESS_CUR (stat( 2301 )-stat( 2351 ))
#define RANK_RANK_PROGRESS_MAX (stat( 2352 )-stat( 2351 ))

P_BACKGROUND( MAIN_X, RANK_RANK_PROGRESS_Y, MAIN_W, RANK_RANK_PROGRESS_H, when( VIS_RANK ) )
itemDef // progress bar
{
	rect			MAIN_X RANK_RANK_PROGRESS_Y 0 RANK_RANK_PROGRESS_H 0 0
	exp				rect W( RANK_RANK_CENTER_X+((RANK_RANK_PROGRESS_CUR / RANK_RANK_PROGRESS_MAX)*RANK_RANK_CENTER_W) );
	style			WINDOW_STYLE_FILLED
	backcolor		C_HIGHLIGHT
	visible			when( VIS_RANK )
}
T_DYNAMIC( MAIN_X, RANK_RANK_PROGRESS_Y, MAIN_W, RANK_RANK_PROGRESS_H, stat( 2301 ) + " / " + stat( 2352 ), FONTSCALE_18, C_TEXT, ITEM_ALIGN_MIDDLE_CENTER, when( VIS_RANK ) )

P_BACKGROUND( RANK_RANK_PROGRESS_TICK_LEFT_X, (RANK_RANK_PROGRESS_Y-((RANK_RANK_PROGRESS_TICK_H-RANK_RANK_PROGRESS_H)*0.5)), RANK_RANK_PROGRESS_TICK_W, RANK_RANK_PROGRESS_TICK_H, when( VIS_RANK ) )
P_BACKGROUND( RANK_RANK_PROGRESS_TICK_RIGHT_X, (RANK_RANK_PROGRESS_Y-((RANK_RANK_PROGRESS_TICK_H-RANK_RANK_PROGRESS_H)*0.5)), RANK_RANK_PROGRESS_TICK_W, RANK_RANK_PROGRESS_TICK_H, when( VIS_RANK ) )

// left
#define RANK_RANK_LEFT_NAME_W RANK_RANK_LEFT_W
#define RANK_RANK_LEFT_NAME_H 20
#define RANK_RANK_LEFT_NAME_X RANK_RANK_LEFT_X
#define RANK_RANK_LEFT_NAME_Y (RANK_RANK_PROGRESS_Y-RANK_RANK_LEFT_NAME_H)

#define RANK_RANK_LEFT_ICON_W (RANK_RANK_LEFT_W*0.20)
#define RANK_RANK_LEFT_ICON_H RANK_RANK_LEFT_ICON_W
#define RANK_RANK_LEFT_ICON_X (RANK_RANK_LEFT_X+((RANK_RANK_LEFT_W-RANK_RANK_LEFT_ICON_W)*0.5))
#define RANK_RANK_LEFT_ICON_Y (RANK_RANK_PROGRESS_Y-RANK_RANK_LEFT_NAME_H-RANK_RANK_LEFT_ICON_H)

#define RANK_RANK_LEFT_LEVEL_W RANK_RANK_LEFT_W
#define RANK_RANK_LEFT_LEVEL_H 20
#define RANK_RANK_LEFT_LEVEL_X RANK_RANK_LEFT_X
#define RANK_RANK_LEFT_LEVEL_Y (RANK_RANK_PROGRESS_Y+RANK_RANK_PROGRESS_H)

M_DYNAMIC( RANK_RANK_LEFT_ICON_X, RANK_RANK_LEFT_ICON_Y, RANK_RANK_LEFT_ICON_W, RANK_RANK_LEFT_ICON_H, TableLookUp( "mp/rankicontable.csv", 0, (RANK_LAST_RANK-1), 1 ), 1 1 1 1, when( VIS_RANK ) )
T_DYNAMIC( RANK_RANK_LEFT_NAME_X, RANK_RANK_LEFT_NAME_Y, RANK_RANK_LEFT_NAME_W, RANK_RANK_LEFT_NAME_H, "@"+TableLookUp( "mp/rankicontable.csv", 0, (RANK_LAST_RANK-1), 2 ), FONTSCALE_16, C_TEXT, ITEM_ALIGN_MIDDLE_CENTER, when( VIS_RANK ) )
T_DYNAMIC( RANK_RANK_LEFT_LEVEL_X, RANK_RANK_LEFT_LEVEL_Y, RANK_RANK_LEFT_LEVEL_W, RANK_RANK_LEFT_LEVEL_H, RANK_LAST_RANK, FONTSCALE_16, C_TEXT, ITEM_ALIGN_MIDDLE_CENTER, when( VIS_RANK ) )

// center
#define RANK_RANK_CENTER_NAME_W RANK_RANK_CENTER_W
#define RANK_RANK_CENTER_NAME_H 26
#define RANK_RANK_CENTER_NAME_X RANK_RANK_CENTER_X
#define RANK_RANK_CENTER_NAME_Y (RANK_RANK_PROGRESS_Y-RANK_RANK_CENTER_NAME_H)

#define RANK_RANK_CENTER_ICON_W (RANK_RANK_CENTER_W*0.15)
#define RANK_RANK_CENTER_ICON_H RANK_RANK_CENTER_ICON_W
#define RANK_RANK_CENTER_ICON_X (RANK_RANK_CENTER_X+((RANK_RANK_CENTER_W-RANK_RANK_CENTER_ICON_W)*0.5))
#define RANK_RANK_CENTER_ICON_Y (RANK_RANK_PROGRESS_Y-RANK_RANK_CENTER_NAME_H-RANK_RANK_CENTER_ICON_H)

#define RANK_RANK_CENTER_LEVEL_W RANK_RANK_CENTER_W
#define RANK_RANK_CENTER_LEVEL_H 26
#define RANK_RANK_CENTER_LEVEL_X RANK_RANK_CENTER_X
#define RANK_RANK_CENTER_LEVEL_Y (RANK_RANK_PROGRESS_Y+RANK_RANK_PROGRESS_H)

M_DYNAMIC( RANK_RANK_CENTER_ICON_X, RANK_RANK_CENTER_ICON_Y, RANK_RANK_CENTER_ICON_W, RANK_RANK_CENTER_ICON_H, TableLookUp( "mp/rankicontable.csv", 0, (RANK_CURRENT_RANK-1), 1 ), 1 1 1 1, when( VIS_RANK ) )
T_DYNAMIC( RANK_RANK_CENTER_NAME_X, RANK_RANK_CENTER_NAME_Y, RANK_RANK_CENTER_NAME_W, RANK_RANK_CENTER_NAME_H, "@"+TableLookUp( "mp/rankicontable.csv", 0, (RANK_CURRENT_RANK-1), 2 ), FONTSCALE_24, C_TEXT, ITEM_ALIGN_MIDDLE_CENTER, when( VIS_RANK ) )
T_DYNAMIC( RANK_RANK_CENTER_LEVEL_X, RANK_RANK_CENTER_LEVEL_Y, RANK_RANK_CENTER_LEVEL_W, RANK_RANK_CENTER_LEVEL_H, RANK_CURRENT_RANK, FONTSCALE_24, C_TEXT, ITEM_ALIGN_MIDDLE_CENTER, when( VIS_RANK ) )

// right
#define RANK_RANK_RIGHT_NAME_W RANK_RANK_RIGHT_W
#define RANK_RANK_RIGHT_NAME_H 20
#define RANK_RANK_RIGHT_NAME_X RANK_RANK_RIGHT_X
#define RANK_RANK_RIGHT_NAME_Y (RANK_RANK_PROGRESS_Y-RANK_RANK_RIGHT_NAME_H)

#define RANK_RANK_RIGHT_ICON_W (RANK_RANK_RIGHT_W*0.20)
#define RANK_RANK_RIGHT_ICON_H RANK_RANK_RIGHT_ICON_W
#define RANK_RANK_RIGHT_ICON_X (RANK_RANK_RIGHT_X+((RANK_RANK_RIGHT_W-RANK_RANK_RIGHT_ICON_W)*0.5))
#define RANK_RANK_RIGHT_ICON_Y (RANK_RANK_PROGRESS_Y-RANK_RANK_RIGHT_NAME_H-RANK_RANK_RIGHT_ICON_H)

#define RANK_RANK_RIGHT_LEVEL_W RANK_RANK_RIGHT_W
#define RANK_RANK_RIGHT_LEVEL_H 20
#define RANK_RANK_RIGHT_LEVEL_X RANK_RANK_RIGHT_X
#define RANK_RANK_RIGHT_LEVEL_Y (RANK_RANK_PROGRESS_Y+RANK_RANK_PROGRESS_H)

M_DYNAMIC( RANK_RANK_RIGHT_ICON_X, RANK_RANK_RIGHT_ICON_Y, RANK_RANK_RIGHT_ICON_W, RANK_RANK_RIGHT_ICON_H, TableLookUp( "mp/rankicontable.csv", 0, (RANK_NEXT_RANK-1), 1 ), 1 1 1 1, when( VIS_RANK ) )
T_DYNAMIC( RANK_RANK_RIGHT_NAME_X, RANK_RANK_RIGHT_NAME_Y, RANK_RANK_RIGHT_NAME_W, RANK_RANK_RIGHT_NAME_H, "@"+TableLookUp( "mp/rankicontable.csv", 0, (RANK_NEXT_RANK-1), 2 ), FONTSCALE_16, C_TEXT, ITEM_ALIGN_MIDDLE_CENTER, when( VIS_RANK ) )
T_DYNAMIC( RANK_RANK_RIGHT_LEVEL_X, RANK_RANK_RIGHT_LEVEL_Y, RANK_RANK_RIGHT_LEVEL_W, RANK_RANK_RIGHT_LEVEL_H, RANK_NEXT_RANK, FONTSCALE_16, C_TEXT, ITEM_ALIGN_MIDDLE_CENTER, when( VIS_RANK ) )

// bottom stats panel
#define RANK_STATS_ITEM_H 16
#define RANK_STATS_ITEM_C 5

#define RANK_STATS_W (MAIN_W*0.35)
#define RANK_STATS_H (RANK_STATS_ITEM_C*RANK_STATS_ITEM_H)
#define RANK_STATS_X ((MAIN_X+(MAIN_W*0.5))-(RANK_STATS_W*0.5))
#define RANK_STATS_Y ((MAIN_Y+MAIN_H)-RANK_STATS_H)

#define RANK_STATS_ITEM( num, T, V ) \
	T_STATIC( RANK_STATS_X, (RANK_STATS_Y+(num*RANK_STATS_ITEM_H)), RANK_STATS_W, RANK_STATS_ITEM_H, T, FONTSCALE_14, C_TEXT, ITEM_ALIGN_MIDDLE_LEFT, when( VIS_RANK ) ) \
	T_DYNAMIC( RANK_STATS_X, (RANK_STATS_Y+(num*RANK_STATS_ITEM_H)), RANK_STATS_W, RANK_STATS_ITEM_H, V, FONTSCALE_14, C_TEXT, ITEM_ALIGN_MIDDLE_RIGHT, when( VIS_RANK ) ) \

P_BACKGROUND( MAIN_X, RANK_STATS_Y, MAIN_W, RANK_STATS_H, when( VIS_RANK ) )
	
RANK_STATS_ITEM( 0, "Kills", stat( 2303 ) )
RANK_STATS_ITEM( 1, "    People", stat( 2312 ) )
RANK_STATS_ITEM( 2, "    Monsters", stat( 2313 ) )
RANK_STATS_ITEM( 3, "Deaths", stat( 2305 ) )
RANK_STATS_ITEM( 4, "Time Played", secondsAsTime( stat( 2314 ) ) )